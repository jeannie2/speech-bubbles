<style>
  html,
  body {
    height: 100%;
    margin: 0;
  }

  /*#strawberry {
      //h2#strawberry
      font-size: 130px;
      position: fixed;
      // Will override color (regardless of order)
      -webkit-text-stroke-width: 2px;
      right: 43%; //space for border
      //-webkit-text-stroke-color: green;
      border: 2px solid pink;
    } */
</style>

<script>
  //initialise gameOver, speaking in global scope (or else no defined until run functions) and in case proceed at start

  //delete below?
  var synth = window.speechSynthesis;
  var speaking = synth.speaking;
  var speaking = false;

  //var results = document.getElementById("results"); //easier
  //var sound = document.getElementById("sound");
  //var listening = false;
  /*
        if(transcript.length > 1) {}
        if(transcript.length > 5) {}
        if(transcript.length > 8) {}
        */

  ///////////svg creating, need duplicate
  /*function randomNumber() {
            var randomNumber = Math.floor(Math.random() * 101); // returns a random integer from 0 to 100
            //Math.floor(Math.random()*100) + 1;
            return randomNumber;
          } */

  /* should there be a maximum height?
        <foreignObject x="20" y="90" width="150" height="200">
                <p xmlns="http://www.w3.org/1999/xhtml">ererereree</p>
                </foreignObject>

                <text x="20" y="20"></text>
        */
  //add switch statement

  document.body.onkeyup = function (e) {
    //order matters. if gameover last condition: when gameover and continue press spacebar, prints "message showing" rather than "game Over" when continue press spacebar
    //some condiitons redundant
    //if(media.srcs) {
    if (e.keyCode == 32) {
      //spacebar
      runSpeechRecognition();
      // loadFont(strawberry);
      //svgBubble();
    }
  };

  /* window.onpopstate=function(){ alert("Back/Forward clicked!"); } */

  //Math.floor(Math.random() * (qs-1) - min + 1) + min);
  //document.getElementById("fox").style.pattern;

  //()
  /*
            setTimeout(function(){
                console.log("mr potato");
                // styles not applying?
                // var strawberry = document.querySelector("h2#strawberry");
                strawberry.parentNode.removeChild(strawberry);
                 }, 3000);
        */

  // div.id = "strawberry";

  /*
        function randomNumber() {
                const r = Math.floor(Math.random() * 256);
                const g = Math.floor(Math.random() * 256);
                const b = Math.floor(Math.random() * 256);
        }
        */

  //strawberry.textContent = "u don't say";

  //delete?
  function createText() {
    var strawberry = document.createElement("p");
    loadFont(strawberry);
    document.body.appendChild(strawberry);

    var height = strawberry.clientHeight + 1 + "px";
    var width = strawberry.clientWidth + 1 + "px";
    console.log("after append: height:" + height + " width: " + width);
    //return r,g,b,a
  }

  // manually add pattern code. also sets backgroud of bubble

  function loadFont(strawberry, transcript) {
    const r = Math.floor(Math.random() * 256);
    const g = Math.floor(Math.random() * 256);
    const b = Math.floor(Math.random() * 256);
    const a = Math.random(); // 0.0 to 1.0
    // const p = 15;
    // -webkit-text-stroke-width: 1px;
    // strawberry.style.right="43%";
    // newspaper.style.color = //random color or fixed?
    //strawberry.style.position = "fixed"; // try absolute. QQ fixed inline-block not sure about

    // strawberry.style.margin = "0px";

    function createBubble(strawberry) {
      const r = Math.floor(Math.random() * 256); // 0 to 25
      const g = Math.floor(Math.random() * 256);
      const b = Math.floor(Math.random() * 256);
      const a = Math.random(); // Math.random(). 0.0 to 1.0
      console.log("CALLIPSO");
      // calcualte p dimensions. global?
      // var fontSize = 30;

      /*
      var vanilla = document.createElement('div');
      document.body.appendChild(vanilla);
      vanilla.id="vanilla";
      vanilla.style.height= height;
      vanilla.style.width= width;
        */

      ellipse.style.position = "fixed";

      //ellipse.style.margin = "0px";
      // return r,g,b,a
      // ellipse.style.textAlign = "center"; // added
      // ellipse.style.backgroundImage = "radial-gradient(#fc5a8d 15%, transparent 2%),radial-gradient(#fc5a8d 15%, transparent 2%)"; // added
      ellipse.style.borderRadius = "50%";

      console.log("right:" + ellipse.style.right);
      // strawberry.style.color = "rgba(" + r + "," + g + "," + b + "," + a + ")" ;

      // var documentFragment = document.createDocumentFragment();
      setTimeout(function () {
        //  fragment.appendChild(ellipse);
        strawberry.style.visibility = "visible";
        ellipse.style.visibility = "visible";
        // ellipse.style.display = "block";

        // var documentFragment = document.createDocumentFragment();
        // documentFragment.append(strawberry);
        // documentFragment.append(ellipse);
        // document.body.appendChild(documentFragment);
        // documentFragment.appendChild(listItem);
        // document.body.appendChild(strawberry);
        // strawberry.style.color = "red";
        //  document.body.appendChild(ellipse);
        // listItem.appendChild(strawberry);
        // listItem.appendChild(ellipse);
        // document.body.appendChild(ellipse);
        setTimeout(function () {
          //     document.body.removeChild(ellipse);
          //      strawberry.style.visibility = "hidden";
          //      ellipse.style.visibility = "hidden";
        }, (removeDelay += 2000));
        // console.log("removeDelay: " + removeDelay);
        //  ellipse.remove();
        //   strawberry.remove();
      }, (bubbleDelay += 200));
      // bubbleDelay = bubbleDelay + 200; // will leave out return since works without
    }
  }

  recognition.onresult = function (event) {
    var confidence = event.results[0][0].confidence;
    var spokenTranscript = event.results[0][0].transcript; // var transcript = event.results[0][0].transcript;
    console.log("transcript: " + spokenTranscript);
    console.log("confidence: " + confidence * 100 + "%");

    /*test without */
    //const choosedFont = loadRandomFont(fontsList);
    // updateFont(el, choosedFont);

    // FOW NOW  ............. loadFont(strawberry, transcript);
    // FOR NOW  ................ document.getElementById("strawberry").textContent = transcript;

    // transcript = transcript.toUpperCase();
    // checkAnswer(transcript, gum);

    //var spokenTranscript = event.result[0][0].transcript; //poemspeak

    testMeat(spokenTranscript); //poemspeak
  };

  /*
        function checkAnswer() {
          document.getElementById("icecream").textContent = transcript;
        }
        */

  function testMeat(spokenTranscript) {
    //var noPunctuationDisc;
    //var unformattedDisc;

    // check word in poem

    for (var i = 0; i < transcriptNoSpaces.length; i++) {
      console.log("word: " + transcriptNoSpaces[i]);
      // if (poemArray1.indexOf(transcriptNoSpaces[i]) !== -1) {
      arrayOfElements = [];
      //console.log("within poem"); poemspeak

      // let index = poemArray3.indexOf(transcriptNoSpaces[i]);
      // console.log("index: " + index);
      console.log(
        "transcriptNoSpaces[i]: " + "i: " + i + " " + transcriptNoSpaces[i]
      );

      loadFont(strawberry, transcriptNoSpaces[i]);
      var pindex = transcriptNoSpaces.indexOf(transcriptNoSpaces[i]);
      if (pindex !== -1) {
        transcriptNoSpaces.splice(pindex, 1);
      } //added
      // if (index !== -1) {
      /* poemArray3.splice(index, 1);
              console.log("spliced poemArray3");

              console.log("poemArray2 length: " + poemArray2.length + " poemArray3 length: " + poemArray3.length);
              totalWordsSpoken = (poemArray2.length - poemArray3.length);
              console.log("totalWordsSpoken: " + totalWordsSpoken);
            */
      // }
      //  }
    }
  }

  ///random font part
  //const el = document.getElementById("icecream"); //works?

  /*
      el.addEventListener('click', () => {
          //runSpeechRecognition();
          const choosedFont = loadRandomFont(fontsList);
          updateFont(el, choosedFont);
      });
      */

  // function updateFont(el, choosedFont) {
  // el = newspaper;
  // el.style.fontFamily = choosedFont;
  //el.setAttribute("title", choosedFont);
  //  }

  async function main() {
    fontsList = await loadFontsList();
    //  const choosedFont = loadRandomFont(fontsList);
    //  updateFont(el, choosedFont);
  }
</script>
